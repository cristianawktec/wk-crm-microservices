{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../../services/api.service\";\nimport * as i3 from \"@angular/forms\";\nimport * as i4 from \"@angular/common\";\nfunction CustomerFormComponent_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 11);\n    i0.ɵɵelement(1, \"i\", 12);\n    i0.ɵɵtext(2, \" Carregando...\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CustomerFormComponent_form_12_div_8_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"Nome \\u00E9 obrigat\\u00F3rio\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CustomerFormComponent_form_12_div_8_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"Nome \\u00E9 muito longo\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CustomerFormComponent_form_12_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 26);\n    i0.ɵɵtemplate(1, CustomerFormComponent_form_12_div_8_div_1_Template, 2, 0, \"div\", 27)(2, CustomerFormComponent_form_12_div_8_div_2_Template, 2, 0, \"div\", 27);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.name == null ? null : ctx_r1.name.errors == null ? null : ctx_r1.name.errors[\"required\"]);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.name == null ? null : ctx_r1.name.errors == null ? null : ctx_r1.name.errors[\"maxlength\"]);\n  }\n}\nfunction CustomerFormComponent_form_12_div_13_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"Email inv\\u00E1lido\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CustomerFormComponent_form_12_div_13_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"Email \\u00E9 muito longo\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CustomerFormComponent_form_12_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 26);\n    i0.ɵɵtemplate(1, CustomerFormComponent_form_12_div_13_div_1_Template, 2, 0, \"div\", 27)(2, CustomerFormComponent_form_12_div_13_div_2_Template, 2, 0, \"div\", 27);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.email == null ? null : ctx_r1.email.errors == null ? null : ctx_r1.email.errors[\"email\"]);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.email == null ? null : ctx_r1.email.errors == null ? null : ctx_r1.email.errors[\"maxlength\"]);\n  }\n}\nfunction CustomerFormComponent_form_12_div_19_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"Telefone \\u00E9 muito longo\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CustomerFormComponent_form_12_div_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 26);\n    i0.ɵɵtemplate(1, CustomerFormComponent_form_12_div_19_div_1_Template, 2, 0, \"div\", 27);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.phone == null ? null : ctx_r1.phone.errors == null ? null : ctx_r1.phone.errors[\"maxlength\"]);\n  }\n}\nfunction CustomerFormComponent_form_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"form\", 13);\n    i0.ɵɵlistener(\"ngSubmit\", function CustomerFormComponent_form_12_Template_form_ngSubmit_0_listener() {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.save());\n    });\n    i0.ɵɵelementStart(1, \"div\", 14)(2, \"div\", 15)(3, \"label\", 16);\n    i0.ɵɵtext(4, \"Nome \");\n    i0.ɵɵelementStart(5, \"span\", 17);\n    i0.ɵɵtext(6, \"*\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(7, \"input\", 18);\n    i0.ɵɵtemplate(8, CustomerFormComponent_form_12_div_8_Template, 3, 2, \"div\", 19);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"div\", 15)(10, \"label\", 16);\n    i0.ɵɵtext(11, \"Email\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(12, \"input\", 20);\n    i0.ɵɵtemplate(13, CustomerFormComponent_form_12_div_13_Template, 3, 2, \"div\", 19);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(14, \"div\", 14)(15, \"div\", 21)(16, \"label\", 16);\n    i0.ɵɵtext(17, \"Telefone\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(18, \"input\", 22);\n    i0.ɵɵtemplate(19, CustomerFormComponent_form_12_div_19_Template, 2, 1, \"div\", 19);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(20, \"div\", 23)(21, \"button\", 24);\n    i0.ɵɵtext(22, \"Salvar\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(23, \"button\", 25);\n    i0.ɵɵlistener(\"click\", function CustomerFormComponent_form_12_Template_button_click_23_listener() {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.cancel());\n    });\n    i0.ɵɵtext(24, \"Cancelar\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"formGroup\", ctx_r1.form);\n    i0.ɵɵadvance(8);\n    i0.ɵɵproperty(\"ngIf\", (ctx_r1.name == null ? null : ctx_r1.name.touched) && (ctx_r1.name == null ? null : ctx_r1.name.invalid));\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngIf\", (ctx_r1.email == null ? null : ctx_r1.email.touched) && (ctx_r1.email == null ? null : ctx_r1.email.invalid));\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"ngIf\", (ctx_r1.phone == null ? null : ctx_r1.phone.touched) && (ctx_r1.phone == null ? null : ctx_r1.phone.invalid));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", ctx_r1.form.invalid || ctx_r1.loading);\n  }\n}\nexport let CustomerFormComponent = /*#__PURE__*/(() => {\n  class CustomerFormComponent {\n    constructor(route, api, router, fb) {\n      this.route = route;\n      this.api = api;\n      this.router = router;\n      this.fb = fb;\n      this.loading = false;\n      this.isEdit = false;\n      this.currentId = null;\n      this.form = this.fb.group({\n        name: ['', [Validators.required, Validators.maxLength(120)]],\n        email: ['', [Validators.email, Validators.maxLength(180)]],\n        phone: ['', [Validators.maxLength(40)]]\n      });\n    }\n    ngOnInit() {\n      const id = this.route.snapshot.paramMap.get('id');\n      if (id) {\n        // backend uses UUID strings for customer ids, accept strings here\n        this.isEdit = true;\n        this.currentId = id;\n        this.loading = true;\n        console.log('[CustomerForm] loading customer', this.currentId);\n        this.api.getCustomer(this.currentId).subscribe({\n          next: res => {\n            const data = res?.data || res || {};\n            this.form.patchValue({\n              name: data.name || '',\n              email: data.email || '',\n              phone: data.phone || ''\n            });\n            this.loading = false;\n          },\n          error: () => {\n            this.loading = false;\n            alert('Erro ao carregar cliente');\n          }\n        });\n      }\n    }\n    save() {\n      if (this.form.invalid) {\n        this.form.markAllAsTouched();\n        return;\n      }\n      this.loading = true;\n      const payload = this.form.value;\n      const op = this.isEdit ? this.api.updateCustomer(this.currentId, payload) : this.api.createCustomer(payload);\n      op.subscribe({\n        next: () => {\n          this.loading = false;\n          this.router.navigate(['/customers'], {\n            queryParams: {\n              saved: '1'\n            }\n          });\n        },\n        error: () => {\n          this.loading = false;\n          alert('Erro ao salvar');\n        }\n      });\n    }\n    cancel() {\n      this.router.navigate(['/customers']);\n    }\n    // convenience getters for template\n    get name() {\n      return this.form.get('name');\n    }\n    get email() {\n      return this.form.get('email');\n    }\n    get phone() {\n      return this.form.get('phone');\n    }\n    static {\n      this.ɵfac = function CustomerFormComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || CustomerFormComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.ApiService), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i3.FormBuilder));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: CustomerFormComponent,\n        selectors: [[\"app-customer-form\"]],\n        decls: 13,\n        vars: 3,\n        consts: [[1, \"content-wrapper\"], [1, \"content-header\"], [1, \"container-fluid\"], [1, \"row\", \"mb-2\"], [1, \"col-sm-6\"], [1, \"m-0\"], [1, \"content\"], [\"class\", \"text-center py-3\", 4, \"ngIf\"], [1, \"card\"], [1, \"card-body\"], [\"novalidate\", \"\", 3, \"formGroup\", \"ngSubmit\", 4, \"ngIf\"], [1, \"text-center\", \"py-3\"], [1, \"fas\", \"fa-spinner\", \"fa-spin\"], [\"novalidate\", \"\", 3, \"ngSubmit\", \"formGroup\"], [1, \"row\"], [1, \"col-md-6\", \"mb-3\"], [1, \"form-label\"], [1, \"text-danger\"], [\"formControlName\", \"name\", 1, \"form-control\"], [\"class\", \"form-text text-danger\", 4, \"ngIf\"], [\"formControlName\", \"email\", \"type\", \"email\", 1, \"form-control\"], [1, \"col-md-4\", \"mb-3\"], [\"formControlName\", \"phone\", 1, \"form-control\"], [1, \"mt-3\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", 3, \"disabled\"], [\"type\", \"button\", 1, \"btn\", \"btn-secondary\", \"ms-2\", 3, \"click\"], [1, \"form-text\", \"text-danger\"], [4, \"ngIf\"]],\n        template: function CustomerFormComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"div\", 4)(5, \"h1\", 5);\n            i0.ɵɵtext(6);\n            i0.ɵɵelementEnd()()()()();\n            i0.ɵɵelementStart(7, \"section\", 6)(8, \"div\", 2);\n            i0.ɵɵtemplate(9, CustomerFormComponent_div_9_Template, 3, 0, \"div\", 7);\n            i0.ɵɵelementStart(10, \"div\", 8)(11, \"div\", 9);\n            i0.ɵɵtemplate(12, CustomerFormComponent_form_12_Template, 25, 5, \"form\", 10);\n            i0.ɵɵelementEnd()()()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(6);\n            i0.ɵɵtextInterpolate1(\"\", ctx.isEdit ? \"Editar\" : \"Novo\", \" Cliente\");\n            i0.ɵɵadvance(3);\n            i0.ɵɵproperty(\"ngIf\", ctx.loading);\n            i0.ɵɵadvance(3);\n            i0.ɵɵproperty(\"ngIf\", !ctx.loading);\n          }\n        },\n        dependencies: [i4.NgIf, i3.ɵNgNoValidate, i3.DefaultValueAccessor, i3.NgControlStatus, i3.NgControlStatusGroup, i3.FormGroupDirective, i3.FormControlName],\n        styles: [\".content-wrapper[_ngcontent-%COMP%]{padding:15px}.mb-3[_ngcontent-%COMP%]{margin-bottom:1rem}.form-label[_ngcontent-%COMP%]{font-weight:600}\"]\n      });\n    }\n  }\n  return CustomerFormComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}