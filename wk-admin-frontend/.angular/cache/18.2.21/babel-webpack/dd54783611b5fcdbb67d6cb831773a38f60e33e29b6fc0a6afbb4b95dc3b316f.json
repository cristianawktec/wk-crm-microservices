{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/api.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/common\";\nfunction OpportunitiesComponent_div_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 14);\n    i0.ɵɵtext(1, \"Carregando...\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction OpportunitiesComponent_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 15);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(ctx_r0.error);\n  }\n}\nfunction OpportunitiesComponent_table_14_tr_15_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtext(8);\n    i0.ɵɵpipe(9, \"currency\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"td\");\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"td\", 18)(13, \"button\", 19);\n    i0.ɵɵlistener(\"click\", function OpportunitiesComponent_table_14_tr_15_Template_button_click_13_listener() {\n      const o_r3 = i0.ɵɵrestoreView(_r2).$implicit;\n      const ctx_r0 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r0.edit(o_r3.id));\n    });\n    i0.ɵɵtext(14, \"Editar\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"button\", 20);\n    i0.ɵɵlistener(\"click\", function OpportunitiesComponent_table_14_tr_15_Template_button_click_15_listener() {\n      const o_r3 = i0.ɵɵrestoreView(_r2).$implicit;\n      const ctx_r0 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r0.delete(o_r3.id));\n    });\n    i0.ɵɵtext(16, \"Excluir\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const o_r3 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(o_r3.title);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate((o_r3.client == null ? null : o_r3.client.name) || (o_r3.client == null ? null : o_r3.client.title) || o_r3.client_id || \"-\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate((o_r3.seller == null ? null : o_r3.seller.name) || (o_r3.seller == null ? null : o_r3.seller.title) || o_r3.seller_id || \"-\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(9, 5, o_r3.value, \"BRL\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(o_r3.status);\n  }\n}\nfunction OpportunitiesComponent_table_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"table\", 16)(1, \"thead\")(2, \"tr\")(3, \"th\");\n    i0.ɵɵtext(4, \"T\\u00EDtulo\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"th\");\n    i0.ɵɵtext(6, \"Cliente\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"th\");\n    i0.ɵɵtext(8, \"Vendedor\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"th\");\n    i0.ɵɵtext(10, \"Valor\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"th\");\n    i0.ɵɵtext(12, \"Status\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(13, \"th\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(14, \"tbody\");\n    i0.ɵɵtemplate(15, OpportunitiesComponent_table_14_tr_15_Template, 17, 8, \"tr\", 17);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(15);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.opportunities);\n  }\n}\nfunction OpportunitiesComponent_div_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"Nenhuma oportunidade encontrada.\");\n    i0.ɵɵelementEnd();\n  }\n}\nexport let OpportunitiesComponent = /*#__PURE__*/(() => {\n  class OpportunitiesComponent {\n    constructor(api, router) {\n      this.api = api;\n      this.router = router;\n      this.loading = true;\n      this.opportunities = [];\n      this.error = null;\n    }\n    ngOnInit() {\n      this.load();\n    }\n    load() {\n      this.loading = true;\n      this.error = null;\n      this.api.getOpportunities().subscribe({\n        next: res => {\n          // handle both paginated and array responses\n          if (Array.isArray(res)) this.opportunities = res;else if (res?.data) this.opportunities = res.data;else this.opportunities = res || [];\n          this.loading = false;\n        },\n        error: err => {\n          console.warn('Failed to load opportunities', err);\n          this.error = err?.message || 'Erro ao carregar oportunidades';\n          this.loading = false;\n        }\n      });\n    }\n    goNew() {\n      this.router.navigate(['/opportunities', 'new']);\n    }\n    edit(id) {\n      this.router.navigate(['/opportunities', id]);\n    }\n    delete(id) {\n      if (!confirm('Tem certeza que deseja excluir esta oportunidade?')) return;\n      this.api.deleteOpportunity(id).subscribe({\n        next: () => this.load(),\n        error: () => alert('Erro ao excluir oportunidade')\n      });\n    }\n    static {\n      this.ɵfac = function OpportunitiesComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || OpportunitiesComponent)(i0.ɵɵdirectiveInject(i1.ApiService), i0.ɵɵdirectiveInject(i2.Router));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: OpportunitiesComponent,\n        selectors: [[\"app-opportunities\"]],\n        decls: 16,\n        vars: 4,\n        consts: [[1, \"content\"], [1, \"container-fluid\"], [1, \"row\"], [1, \"col-12\"], [1, \"card\"], [1, \"card-header\"], [1, \"card-title\"], [1, \"card-body\"], [1, \"mb-3\"], [1, \"btn\", \"btn-primary\", 3, \"click\"], [\"class\", \"text-center\", 4, \"ngIf\"], [\"class\", \"alert alert-danger\", 4, \"ngIf\"], [\"class\", \"table table-striped\", 4, \"ngIf\"], [4, \"ngIf\"], [1, \"text-center\"], [1, \"alert\", \"alert-danger\"], [1, \"table\", \"table-striped\"], [4, \"ngFor\", \"ngForOf\"], [1, \"text-right\"], [1, \"btn\", \"btn-sm\", \"btn-secondary\", 3, \"click\"], [1, \"btn\", \"btn-sm\", \"btn-danger\", \"ml-2\", 3, \"click\"]],\n        template: function OpportunitiesComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"section\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"div\", 4)(5, \"div\", 5)(6, \"h3\", 6);\n            i0.ɵɵtext(7, \"Oportunidades\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(8, \"div\", 7)(9, \"div\", 8)(10, \"button\", 9);\n            i0.ɵɵlistener(\"click\", function OpportunitiesComponent_Template_button_click_10_listener() {\n              return ctx.goNew();\n            });\n            i0.ɵɵtext(11, \"Nova Oportunidade\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵtemplate(12, OpportunitiesComponent_div_12_Template, 2, 0, \"div\", 10)(13, OpportunitiesComponent_div_13_Template, 2, 1, \"div\", 11)(14, OpportunitiesComponent_table_14_Template, 16, 1, \"table\", 12)(15, OpportunitiesComponent_div_15_Template, 2, 0, \"div\", 13);\n            i0.ɵɵelementEnd()()()()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(12);\n            i0.ɵɵproperty(\"ngIf\", ctx.loading);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.error);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", !ctx.loading && (ctx.opportunities == null ? null : ctx.opportunities.length));\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", !ctx.loading && (!ctx.opportunities || ctx.opportunities.length === 0));\n          }\n        },\n        dependencies: [i3.NgForOf, i3.NgIf, i3.CurrencyPipe],\n        encapsulation: 2\n      });\n    }\n  }\n  return OpportunitiesComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}