import{d as h,u as y,a as x,b as w,c as d,e as o,w as k,f as p,v as g,g as l,t as v,h as _,i as S,j as C,r as E,o as c}from"./index-5ee73346.js";const I={class:"min-h-screen bg-gradient-to-br from-indigo-600 to-purple-700 flex items-center justify-center p-4"},T={class:"max-w-md w-full bg-white rounded-2xl shadow-2xl p-8"},A={key:0,class:"p-3 bg-red-50 border border-red-200 rounded-lg"},L={class:"text-sm text-red-600"},N=["disabled"],z={key:0},M={key:1,class:"flex items-center justify-center"},V={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},j=["disabled"],B=["disabled"],U=h({__name:"LoginView",setup(D){const u=y(),s=x(),n=w(),i=E({email:"",password:""}),m=async()=>{var a,e;try{await s.login(i.value.email,i.value.password),localStorage.removeItem("loggedOut"),await new Promise(r=>setTimeout(r,100)),console.log("âœ… Login normal completo. Token:",s.token?"presente":"ausente"),console.log("âœ… User:",s.user?"presente":"ausente"),n.success("Login realizado com sucesso!"),u.push("/")}catch(r){n.error(((e=(a=r.response)==null?void 0:a.data)==null?void 0:e.message)||"Erro ao fazer login")}},b=async()=>{var a;try{console.log("ðŸš€ Iniciando login rÃ¡pido...");const e="http://localhost:8000".replace(/\/$/,""),r=await fetch(`${e}/api/auth/test-customer`,{method:"GET",headers:{"Content-Type":"application/json"}});if(r.ok){const t=await r.json();console.log("âœ… Token recebido:",(a=t.token)==null?void 0:a.substring(0,20)),t.success&&t.token&&(localStorage.removeItem("loggedOut"),localStorage.setItem("token",t.token),localStorage.setItem("user",JSON.stringify(t.user)),s.setToken(t.token),s.setUser(t.user),n.success("Login rÃ¡pido realizado!"),u.push("/"))}else n.error("Erro ao fazer login rÃ¡pido")}catch(e){console.error("âŒ Erro no login rÃ¡pido:",e),n.error("Erro ao conectar com o servidor")}},f=async()=>{var a;try{console.log("ðŸš€ Iniciando login rÃ¡pido ADMIN...");const e="http://localhost:8000".replace(/\/$/,""),r=await fetch(`${e}/api/auth/test-customer?role=admin`,{method:"GET",headers:{"Content-Type":"application/json"}});if(r.ok){const t=await r.json();console.log("âœ… Admin token recebido:",(a=t.token)==null?void 0:a.substring(0,20)),t.success&&t.token&&(localStorage.setItem("token",t.token),localStorage.setItem("user",JSON.stringify(t.user)),s.setToken(t.token),s.setUser(t.user),n.success("Login rÃ¡pido ADMIN realizado!"),u.push("/"))}else n.error("Erro ao fazer login rÃ¡pido ADMIN")}catch(e){console.error("âŒ Erro no login rÃ¡pido ADMIN:",e),n.error("Erro ao conectar com o servidor")}};return(a,e)=>(c(),d("div",I,[o("div",T,[e[5]||(e[5]=o("div",{class:"text-center mb-8"},[o("h1",{class:"text-3xl font-bold text-gray-900 mb-2"},"WK CRM"),o("p",{class:"text-gray-600"},"Portal do Cliente")],-1)),o("form",{onSubmit:k(m,["prevent"]),class:"space-y-6"},[o("div",null,[e[2]||(e[2]=o("label",{for:"email",class:"block text-sm font-medium text-gray-700 mb-2"}," Email ",-1)),p(o("input",{id:"email","onUpdate:modelValue":e[0]||(e[0]=r=>i.value.email=r),type:"email",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"seu@email.com"},null,512),[[g,i.value.email]])]),o("div",null,[e[3]||(e[3]=o("label",{for:"password",class:"block text-sm font-medium text-gray-700 mb-2"}," Senha ",-1)),p(o("input",{id:"password","onUpdate:modelValue":e[1]||(e[1]=r=>i.value.password=r),type:"password",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"},null,512),[[g,i.value.password]])]),l(s).error?(c(),d("div",A,[o("p",L,v(l(s).error),1)])):_("",!0),o("button",{type:"submit",disabled:l(s).loading,class:"w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[l(s).loading?(c(),d("span",M,[...e[4]||(e[4]=[o("svg",{class:"animate-spin h-5 w-5 mr-2",viewBox:"0 0 24 24"},[o("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4",fill:"none"}),o("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),S(" Carregando... ",-1)])])):(c(),d("span",z,"Entrar"))],8,N),o("div",V,[o("button",{onClick:b,type:"button",disabled:l(s).loading,class:"w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," ðŸš€ Login RÃ¡pido (Cliente) ",8,j),o("button",{onClick:f,type:"button",disabled:l(s).loading,class:"w-full bg-amber-600 hover:bg-amber-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," ðŸ”‘ Login RÃ¡pido (Admin) ",8,B)])],32),e[6]||(e[6]=C('<p class="mt-6 text-center text-sm text-gray-600"> Esqueceu sua senha? <a href="#" class="text-indigo-600 hover:text-indigo-500 font-medium">Recuperar</a></p><div class="mt-8 pt-6 border-t border-gray-200"><p class="text-center text-xs text-gray-500 mb-3">Acesso para administradores:</p><a href="/admin" target="_blank" class="block w-full text-center bg-gray-800 hover:bg-gray-900 text-white font-semibold py-2 px-4 rounded-lg transition-colors"> ðŸ“Š Ir para Painel Admin </a></div>',2))])]))}});export{U as default};
