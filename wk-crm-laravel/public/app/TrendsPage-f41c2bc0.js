import{d as A,b as J,r as _,l as $,c as t,e as s,t as o,f as q,D as H,h as E,F as k,x as g,i as K,C as Q,o as n,p as W,_ as X}from"./index-a3ac2e85.js";const Y={class:"trends-container"},Z={key:0,class:"loading-state"},ss={key:1,class:"error-state"},es={key:2,class:"trends-content"},os={class:"period-selector"},ls={class:"summary-card"},ts={key:0},ns={class:"kpi-grid"},as={class:"kpi-card"},ds={class:"kpi-content"},is={class:"kpi-value"},rs={class:"kpi-card"},us={class:"kpi-content"},cs={class:"kpi-value"},vs={class:"kpi-card"},ps={class:"kpi-content"},_s={class:"kpi-value"},ms={class:"kpi-card"},ys={class:"kpi-content"},fs={class:"kpi-value"},ks={class:"section"},gs={key:0,class:"sector-table"},bs={key:1,class:"no-data"},hs={class:"section"},Cs={key:0,class:"products-list"},xs={class:"product-rank"},Ss={class:"product-info"},Ts={class:"product-value"},Ms={key:1,class:"no-data"},Ps={class:"section"},Vs={class:"forecast-grid"},ws={class:"forecast-card"},Ds={class:"forecast-value"},Rs={class:"forecast-card"},Ns={class:"forecast-value"},Bs={class:"forecast-card"},Ls={class:"forecast-value"},Os={class:"section"},Fs={key:0,class:"periods-list"},js={class:"period-stats"},Es={key:1,class:"pattern-info"},Us={key:2,class:"no-data"},Gs={class:"section"},Is={class:"cycle-grid"},zs={class:"cycle-card"},As={class:"cycle-value"},Js={class:"cycle-card"},$s={class:"cycle-value"},qs={class:"cycle-card"},Hs={class:"cycle-value"},Ks={class:"cycle-card"},Qs={class:"cycle-value"},Ws=A({__name:"TrendsPage",setup(Xs){const p=J(),m=_(!1),c=_(""),y=_("year"),l=_({}),f=async()=>{var i,e,r;m.value=!0,c.value="";try{l.value=await Q.getTrends(y.value)}catch(d){((i=d.response)==null?void 0:i.status)===401?(c.value="Sess√£o expirada. Por favor, fa√ßa login novamente.",p.error("Sua sess√£o expirou. Por favor, fa√ßa login novamente")):((e=d.response)==null?void 0:e.status)===404?(c.value="Servi√ßo de an√°lise temporariamente indispon√≠vel",console.error("Trends endpoint not found (404)")):c.value="Erro ao conectar ao servidor",console.error("Trend analysis error:",(r=d.response)==null?void 0:r.status,d.message)}finally{m.value=!1}},u=i=>i?new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(i):"R$ 0,00",U=i=>i>=70?"badge-success":i>=50?"badge-warning":"badge-danger",G=()=>{p.info("PDF export em desenvolvimento")},I=()=>{p.info("CSV export em desenvolvimento")},z=()=>{const i=JSON.stringify(l.value,null,2),e=new Blob([i],{type:"application/json"}),r=window.URL.createObjectURL(e),d=document.createElement("a");d.href=r,d.download=`trends-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(d),d.click(),document.body.removeChild(d),window.URL.revokeObjectURL(r),p.success("Relat√≥rio exportado com sucesso!")};return $(()=>{f()}),(i,e)=>{var r,d,b,h,C,x,S,T,M,P,V,w,D,R,N,B,L,O,F,j;return n(),t("div",Y,[e[38]||(e[38]=s("header",{class:"trends-header"},[s("h1",null,"üìä An√°lise de Tend√™ncias"),s("p",null,"Insights detalhados sobre seu desempenho de vendas")],-1)),m.value?(n(),t("div",Z,[...e[1]||(e[1]=[s("div",{class:"spinner"},null,-1),s("p",null,"Gerando an√°lise de tend√™ncias...",-1)])])):c.value?(n(),t("div",ss,[s("p",null,o(c.value),1),s("button",{onClick:f,class:"btn-retry"},"Tentar Novamente")])):(n(),t("div",es,[s("div",os,[e[3]||(e[3]=s("label",null,"Per√≠odo:",-1)),q(s("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>y.value=a),onChange:f},[...e[2]||(e[2]=[s("option",{value:"month"},"√öltimo M√™s",-1),s("option",{value:"quarter"},"√öltimo Trimestre",-1),s("option",{value:"year"},"√öltimo Ano",-1)])],544),[[H,y.value]])]),s("div",ls,[e[4]||(e[4]=s("h3",null,"Resumo Geral",-1)),l.value.summary?(n(),t("p",ts,o(l.value.summary),1)):E("",!0)]),s("div",ns,[s("div",as,[e[6]||(e[6]=s("div",{class:"kpi-icon"},"üìà",-1)),s("div",ds,[e[5]||(e[5]=s("h4",null,"Taxa de Convers√£o",-1)),s("p",is,o(((r=l.value.conversion_trends)==null?void 0:r.conversion_rate)||0)+"%",1),s("small",null,o(((d=l.value.conversion_trends)==null?void 0:d.total)||0)+" oportunidades",1)])]),s("div",rs,[e[8]||(e[8]=s("div",{class:"kpi-icon"},"üéØ",-1)),s("div",us,[e[7]||(e[7]=s("h4",null,"Deals Ganhos",-1)),s("p",cs,o(((b=l.value.conversion_trends)==null?void 0:b.won)||0),1),s("small",null,o(((h=l.value.conversion_trends)==null?void 0:h.lost)||0)+" perdidos",1)])]),s("div",vs,[e[11]||(e[11]=s("div",{class:"kpi-icon"},"üí∞",-1)),s("div",ps,[e[9]||(e[9]=s("h4",null,"Ticket M√©dio",-1)),s("p",_s,o(u((C=l.value.sales_forecast)==null?void 0:C.historical_avg_deal_size)),1),e[10]||(e[10]=s("small",null,"Tamanho hist√≥rico",-1))])]),s("div",ms,[e[14]||(e[14]=s("div",{class:"kpi-icon"},"‚è±Ô∏è",-1)),s("div",ys,[e[12]||(e[12]=s("h4",null,"Ciclo de Vendas",-1)),s("p",fs,o(((x=l.value.cycle_analysis)==null?void 0:x.avg_cycle_days)||0)+"d",1),e[13]||(e[13]=s("small",null,"M√©dia de dias",-1))])])]),s("div",ks,[e[16]||(e[16]=s("h3",null,"Desempenho por Setor üè¢",-1)),((T=(S=l.value.sector_analysis)==null?void 0:S.sectors)==null?void 0:T.length)>0?(n(),t("div",gs,[s("table",null,[e[15]||(e[15]=s("thead",null,[s("tr",null,[s("th",null,"Setor"),s("th",null,"Oportunidades"),s("th",null,"Ganhas"),s("th",null,"Taxa de Convers√£o"),s("th",null,"Valor Total"),s("th",null,"Ticket M√©dio")])],-1)),s("tbody",null,[(n(!0),t(k,null,g(l.value.sector_analysis.sectors,a=>(n(),t("tr",{key:a.sector},[s("td",null,[s("strong",null,o(a.sector),1)]),s("td",null,o(a.total),1),s("td",null,o(a.won),1),s("td",null,[s("span",{class:W(["badge",U(a.conversion_rate)])},o(a.conversion_rate)+"% ",3)]),s("td",null,o(u(a.total_value)),1),s("td",null,o(u(a.avg_value)),1)]))),128))])])])):(n(),t("p",bs,"Sem dados de setor dispon√≠veis"))]),s("div",hs,[e[17]||(e[17]=s("h3",null,"Produtos/Servi√ßos Mais Vendidos üèÜ",-1)),((P=(M=l.value.product_performance)==null?void 0:M.top_products)==null?void 0:P.length)>0?(n(),t("div",Cs,[(n(!0),t(k,null,g(l.value.product_performance.top_products,(a,v)=>(n(),t("div",{key:v,class:"product-item"},[s("div",xs,o(v+1),1),s("div",Ss,[s("h4",null,o(a.title),1),s("small",null,o(a.count)+" venda(s)",1)]),s("div",Ts,o(u(a.total_value)),1)]))),128))])):(n(),t("p",Ms,"Sem produtos vendidos no per√≠odo"))]),s("div",Ps,[e[24]||(e[24]=s("h3",null,"Previs√£o de Vendas üîÆ",-1)),s("div",Vs,[s("div",ws,[e[18]||(e[18]=s("h4",null,"Pr√≥ximos 30 Dias",-1)),s("p",Ds,o(u((V=l.value.sales_forecast)==null?void 0:V.next_30_days)),1),e[19]||(e[19]=s("small",null,"Em oportunidades ativas",-1))]),s("div",Rs,[e[20]||(e[20]=s("h4",null,"M√©dia Mensal",-1)),s("p",Ns,o(u((w=l.value.sales_forecast)==null?void 0:w.monthly_average)),1),e[21]||(e[21]=s("small",null,"Baseado em hist√≥rico",-1))]),s("div",Bs,[e[22]||(e[22]=s("h4",null,"Confian√ßa da Previs√£o",-1)),s("p",Ls,o((D=l.value.sales_forecast)==null?void 0:D.forecast_confidence),1),e[23]||(e[23]=s("small",null,"N√≠vel de certeza",-1))])])]),s("div",Os,[e[27]||(e[27]=s("h3",null,"Melhores Per√≠odos de Venda üìÖ",-1)),((N=(R=l.value.best_periods)==null?void 0:R.best_months)==null?void 0:N.length)>0?(n(),t("div",Fs,[(n(!0),t(k,null,g(l.value.best_periods.best_months,(a,v)=>(n(),t("div",{key:v,class:"period-item"},[e[25]||(e[25]=s("div",{class:"period-rank"},"ü•á",-1)),s("div",js,[s("h4",null,"M√™s "+o(v+1),1),s("p",null,o(a.count)+" oportunidade(s) ganhas",1),s("small",null,"Valor: "+o(u(a.value)),1)])]))),128))])):E("",!0),(B=l.value.best_periods)!=null&&B.pattern?(n(),t("p",Es,[e[26]||(e[26]=s("strong",null,"Padr√£o identificado:",-1)),K(" "+o(l.value.best_periods.pattern),1)])):(n(),t("p",Us,"Sem dados de per√≠odo dispon√≠veis"))]),s("div",Gs,[e[36]||(e[36]=s("h3",null,"An√°lise do Ciclo de Vendas ‚è±Ô∏è",-1)),s("div",Is,[s("div",zs,[e[28]||(e[28]=s("h4",null,"Ciclo M√©dio",-1)),s("p",As,o(((L=l.value.cycle_analysis)==null?void 0:L.avg_cycle_days)||0)+"d",1),e[29]||(e[29]=s("small",null,"Dias at√© fechamento",-1))]),s("div",Js,[e[30]||(e[30]=s("h4",null,"Ciclo Mais R√°pido",-1)),s("p",$s,o(((O=l.value.cycle_analysis)==null?void 0:O.fastest_deal_days)||0)+"d",1),e[31]||(e[31]=s("small",null,"Melhor tempo",-1))]),s("div",qs,[e[32]||(e[32]=s("h4",null,"Ciclo Mais Longo",-1)),s("p",Hs,o(((F=l.value.cycle_analysis)==null?void 0:F.slowest_deal_days)||0)+"d",1),e[33]||(e[33]=s("small",null,"Maior dura√ß√£o",-1))]),s("div",Ks,[e[34]||(e[34]=s("h4",null,"Mediana",-1)),s("p",Qs,o(((j=l.value.cycle_analysis)==null?void 0:j.median_cycle_days)||0)+"d",1),e[35]||(e[35]=s("small",null,"Valor central",-1))])])]),s("div",{class:"section export-section"},[e[37]||(e[37]=s("h3",null,"Exportar Relat√≥rio",-1)),s("div",{class:"export-buttons"},[s("button",{onClick:G,class:"btn-export"},"üìÑ PDF"),s("button",{onClick:I,class:"btn-export"},"üìä CSV"),s("button",{onClick:z,class:"btn-export"},"üìã JSON")])])]))])}}});const Zs=X(Ws,[["__scopeId","data-v-57efb0cc"]]);export{Zs as default};
